<link rel="import" href="lib/core-elements/core-elements.html">

<link rel="import" href="lib/core-animated-pages/transitions/slide-from-right.html">
<link rel="import" href="lib/paper-item/paper-item.html">
<link rel="import" href="lib/paper-tabs/paper-tabs.html">
<link rel="import" href="lib/flatiron-director/flatiron-director.html">
<link rel="import" href="lib/font-roboto/roboto.html">
<link rel="import" href="lib/paper-shadow/paper-shadow.html">

<link rel="import" href="lib/core-ajax/core-ajax.html">

<link rel="import" href="lib/core-icon/core-icon.html">

<link rel="import" href="lib/core-icons/social-icons.html">
<link rel="import" href="lib/core-icons/core-icons.html">

<link rel="import" href="twittargh-toolbar.html">
<link rel="import" href="twittargh-dashboard.html">
<link rel="import" href="twittargh-sign-in.html">
<link rel="import" href="twittargh-globals.html">

<polymer-element name="twittargh-app" vertical layout>
    <template>

        <twittargh-globals id="globals"></twittargh-globals>

        <template if="{{!$.globals.values.user}}" id="disconnected-view">
            <twittargh-sign-in></twittargh-sign-in>
        </template>

        <template if="{{$.globals.values.user}}" id="connected-view">
            <style>
                * {
                    font-family: "RobotoDraft";
                    font-weight: 300;
                }
            </style>

            <twittargh-dashboard></twittargh-dashboard>
            <twittargh-toolbar tool></twittargh-toolbar>
        </template>

        <core-ajax
                auto
                id="ajaxGetAuthentication"
                url="/api/getAuthentication"
                method="GET"
                handleAs="json"
                on-core-response="{{getAuthentication}}"
                on-core-error="{{getAuthentication}}">
        </core-ajax>

    </template>

    <script>
        Polymer('twittargh-app', {
            logged: false,

            ready: function() {
                this.logged = !!this.$.globals.user;
            },

            getAuthentication: function(event, result) {
                console.log(event, result);
                //this.logged = (result.response.statusCode !== 401);
            },

            buttonClick: function (event, detail, sender) {
                this.$.ajaxGetAuthentication.go();
            }
        });
    </script>

</polymer-element>
